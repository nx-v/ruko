\* ============================================================
   15 — EMBEDDED FOREIGN SCRIPT BLOCKS
   Corresponds to: ruko.tmLanguage.yaml lines 4326–4710
   Two syntactic forms to embed foreign-language code:
     1. Block form:    lang { ... }
     2. Literal form:  %lang ... lang%
   All supported languages listed here.
   ============================================================ *\

// ============================================================
// BLOCK FORM: lang { ... }
// The language keyword is followed by a curly-brace block.
// ============================================================

// Web languages
script js {
  function greet(name) {
    console.log(`Hello, ${name}!`)
  }
}

script jsx {
  function App() {
    return <h1>Hello JSX</h1>
  }
}

script ts {
  function add(a: number, b: number): number {
    return a + b
  }
}

script tsx {
  const Button: React.FC<{label: string}> = ({label}) => (
    <button>{label}</button>
  )
}

script css {
  .container {
    display: flex;
    gap: 1rem;
  }
}

script scss {
  $primary: #3498db;
  .btn { background: $primary; }
}

script less {
  @primary: #3498db;
  .btn { background: @primary; }
}

script html {
  <!DOCTYPE html>
  <html lang="en"><body><h1>Hi</h1></body></html>
}

script json {
  { "name": "Ruko", "version": "0.1.0" }
}

script yaml {
  name: Ruko
  version: 0.1.0
  features:
    - wasm
    - webgpu
}

script gql {
  query GetUser($id: ID!) {
    user(id: $id) { id name email }
  }
}

// Systems languages
script c {
  int add(int a, int b) { return a + b; }
}

script cpp {
  template<typename T>
  T max(T a, T b) { return a > b ? a : b; }
}

script rs {
  pub fn fib(n: u64) -> u64 {
      match n { 0 | 1 => n, _ => fib(n-1) + fib(n-2) }
  }
}

script go {
  func add(a, b int) int { return a + b }
}

// JVM languages
script java {
  public class Hello {
    public static void main(String[] args) {
      System.out.println("Hello, World!");
    }
  }
}

script kt {
  fun main() = println("Hello, Kotlin!")
}

script scala {
  def fib(n: Int): Int = if (n <= 1) n else fib(n-1) + fib(n-2)
}

// .NET
script cs {
  int Square(int x) => x * x;
}

script vb {
  Function Add(a As Integer, b As Integer) As Integer
    Return a + b
  End Function
}

// FP languages
script hs {
  fib :: Int -> Int
  fib 0 = 0
  fib 1 = 1
  fib n = fib (n-1) + fib (n-2)
}

script ml {
  let rec fib = function 0 -> 0 | 1 -> 1 | n -> fib(n-1) + fib(n-2)
}

script ocaml {
  let rec fib n = if n <= 1 then n else fib (n-1) + fib (n-2)
}

script fs {
  let rec fib = function 0 -> 0 | 1 -> 1 | n -> fib(n-1) + fib(n-2)
}

script elm {
  fib : Int -> Int
  fib n = if n <= 1 then n else fib (n-1) + fib (n-2)
}

// Scripting languages
script py {
  def fib(n):
    return n if n <= 1 else fib(n-1) + fib(n-2)
}

script rb {
  def fib(n)
    n <= 1 ? n : fib(n-1) + fib(n-2)
  end
}

script php {
  function fib($n) {
    return $n <= 1 ? $n : fib($n-1) + fib($n-2);
  }
}

script lua {
  function fib(n)
    return n <= 1 and n or fib(n-1) + fib(n-2)
  end
}

script perl {
  sub fib { my $n = shift; $n <= 1 ? $n : fib($n-1) + fib($n-2) }
}

script r {
  fib <- function(n) if (n <= 1) n else fib(n-1) + fib(n-2)
}

// Shader languages
script glsl {
  void main() {
    gl_FragColor = vec4(1.0, 0.5, 0.0, 1.0);
  }
}

script wgsl {
  @fragment
  fn main() -> @location(0) vec4<f32> {
    return vec4<f32>(1.0, 0.5, 0.0, 1.0);
  }
}

// Shell and build
script sh {
  #!/bin/bash
  echo "Hello, World!"
  for f in *.rk; do echo "$f"; done
}

script ps1 {
  Write-Host "Hello, PowerShell!"
  Get-ChildItem *.rk | ForEach-Object { $_.Name }
}

// Data languages
script sql {
  SELECT u.name, COUNT(*) AS n
  FROM users u JOIN orders o ON o.user_id = u.id
  GROUP BY u.id ORDER BY n DESC
}

script xml {
  <root>
    <item id="1">Hello</item>
  </root>
}

// Other languages
script dart {
  int fib(int n) => n <= 1 ? n : fib(n-1) + fib(n-2);
}

script swift {
  func fib(_ n: Int) -> Int { n <= 1 ? n : fib(n-1) + fib(n-2) }
}

script jl {
  fib(n) = n <= 1 ? n : fib(n-1) + fib(n-2)
}

script ex {
  def fib(0), do: 0
  def fib(1), do: 1
  def fib(n), do: fib(n-1) + fib(n-2)
}

script clj {
  (defn fib [n]
    (if (<= n 1) n (+ (fib (- n 1)) (fib (- n 2)))))
}

script groovy {
  def fib(n) { n <= 1 ? n : fib(n-1) + fib(n-2) }
}

script sol {
  function add(uint a, uint b) public pure returns (uint) {
    return a + b;
  }
}

script mo {
  func add(a: Nat, b: Nat) : Nat { a + b }
}

script re {
  # Extended Python-style regex block
  (?P<year>  \d{4} )  -
  (?P<month> \d{2} )  -
  (?P<day>   \d{2} )
}

script markdown {
  # Embedded Markdown

  This is **bold** and *italic* text.
}

script latex {
  \documentclass{article}
  \begin{document}
    $E = mc^2$
  \end{document}
}

script toml {
  [package]
  name = "ruko"
  version = "0.1.0"
}

script wat {
  (module
    (func $add (param i32 i32) (result i32)
      local.get 0 local.get 1 i32.add))
}
